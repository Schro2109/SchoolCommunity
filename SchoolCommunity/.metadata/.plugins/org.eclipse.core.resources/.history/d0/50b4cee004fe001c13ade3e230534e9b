DROP TABLE ACCOUNT_TBL;
CREATE TABLE ACCOUNT_TBL(
	ID VARCHAR2(20) NOT NULL PRIMARY KEY,
	PASSWORD VARCHAR2(20) NOT NULL,
	NAME VARCHAR2(30) NOT NULL
);
INSERT INTO ACCOUNT_TBL VALUES('admin','1234','관리자');
select * from ACCOUNT_TBL;
DROP TABLE POST_TBL;
CREATE TABLE POST_TBL(
	PCODE NUMBER(6) NOT NULL PRIMARY KEY,
	PTYPE CHAR(4) NOT NULL CHECK(PTYPE IN ('NEWS', 'FREE', 'QUES')),
	WRITER VARCHAR2(20) NOT NULL,
	TITLE VARCHAR2(100) NOT NULL,
	CONTENTS VARCHAR2(1000),
	SUGGESTION NUMBER(6) DEFAULT 0,
	FOREIGN KEY (WRITER) REFERENCES ACCOUNT_TBL (ID)
);
SELECT * FROM POST_TBL;
DELETE FROM POST_TBL;
INSERT INTO POST_TBL VALUES(1,'NEWS','admin','공지사항테스트제목','공지사항테스트내용입니다.',0);
INSERT INTO POST_TBL VALUES(2,'FREE','admin','자유게시판테스트제목','자유게시판테스트내용입니다.',0);
INSERT INTO POST_TBL VALUES(3,'QUES','admin','Q&A테스트제목','Q&A테스트내용입니다.',0);

--홈 게시판 내용 출력
SELECT PTYPE,TITLE,NAME,SUGGESTION,COUNT(Y.CMCODE) COMMENTCOUNT
FROM (SELECT PTYPE,TITLE,NAME,SUGGESTION
FROM POST_TBL LEFT OUTER JOIN ACCOUNT_TBL ON(WRITER=ID)) X LEFT OUTER JOIN (SELECT CMCODE, PCODE, NAME FROM COMMENT_TBL X LEFT OUTER JOIN ACCOUNT_TBL Y ON(WRITER=ID)) Y ON(X.PCODE=Y.PCODE)
GROUP BY PTYPE,TITLE,NAME,SUGGESTION



DROP TABLE COMMENT_TBL;
CREATE TABLE COMMENT_TBL(
	CMCODE NUMBER(6) NOT NULL PRIMARY KEY,
	PCODE NUMBER(6) NOT NULL,
	WRITER VARCHAR2(20),
	CONTENTS VARCHAR2(500),
	FOREIGN KEY (WRITER) REFERENCES ACCOUNT_TBL (ID),
	FOREIGN KEY (PCODE) REFERENCES POST_TBL (PCODE)
);
SELECT * FROM TAB
DROP TABLE REPLY_TBL;
CREATE TABLE REPLY_TBL(
	RECODE NUMBER(6) NOT NULL PRIMARY KEY,
	CMCODE NUMBER(6) NOT NULL,
	WRITER VARCHAR2(20),
	CONTENTS VARCHAR2(500),
	FOREIGN KEY (WRITER) REFERENCES ACCOUNT_TBL (ID),
	FOREIGN KEY (CMCODE) REFERENCES COMMENT_TBL (CMCODE)
);

SELECT ID FROM ACCOUNT_TBL WHERE ID='admin' AND PASSWORD='1234'